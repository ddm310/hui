<script>
async function generateSmart() {
    const prompt = document.getElementById('prompt').value;
    const model = document.getElementById('model-select').value;
    const imageFile = document.getElementById('image-upload').files[0];
    
    const formData = new FormData();
    formData.append('prompt', prompt);
    formData.append('model', model);
    if (imageFile) {
        formData.append('image', imageFile);
    }
    
    const response = await fetch('/generate-smart', {
        method: 'POST',
        body: formData
    });
    
    if (response.ok) {
        // Обработка успешного ответа
        const imageBlob = await response.blob();
        const imageUrl = URL.createObjectURL(imageBlob);
        document.getElementById('result').innerHTML = `
            <p>✅ Изображение готово!</p>
            <img src="${imageUrl}" alt="Generated image">
        `;
    } else {
        const error = await response.json();
        document.getElementById('result').innerHTML = `
            <p style="color: red;">❌ Ошибка: ${error.error}</p>
        `;
    }
}
</script>
